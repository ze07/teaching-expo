<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Excel — Masterclass · Teaching Expo (UMKB)</title>

<!-- Styles: UMKB palette, responsive, print-friendly -->
<style>
  :root{
    --umkb-blue:#0B3D91;
    --umkb-green:#006b3f;
    --umkb-orange:#E67E22;
    --accent-red:#c8102e;
    --bg:#f6f8fc;
    --text:#22262a;
    --card:#ffffff;
  }
  html,body{height:100%}
  body{
    margin:0;
    font-family: "Inter", "Segoe UI", system-ui, -apple-system, "Helvetica Neue", Arial;
    background:var(--bg);
    color:var(--text);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    line-height:1.6;
    padding-bottom:80px;
  }

  /* Top hero */
  .hero{
    background:linear-gradient(90deg,var(--umkb-green),var(--umkb-blue));
    color:white;
    padding:48px 20px;
    text-align:center;
  }
  .hero .logo{
    height:72px;
    display:block;
    margin:0 auto 12px;
  }
  .hero h1{font-size:34px;margin:6px 0 8px;font-weight:700}
  .hero p{opacity:.95;margin:0 auto;max-width:900px}

  /* Layout: sticky toc + content */
  .wrap{
    display:grid;
    grid-template-columns: 280px 1fr;
    gap:28px;
    width:90%;
    max-width:1200px;
    margin:28px auto;
  }
  @media (max-width:900px){
    .wrap{grid-template-columns:1fr;padding:0 12px}
    .toc{position:static;order: -1}
  }

  /* TOC */
  .toc{
    position:sticky;
    top:18px;
    height:calc(100vh - 36px);
    overflow:auto;
    padding:18px;
    background:var(--card);
    border-radius:12px;
    box-shadow:0 6px 18px rgba(10,20,40,0.06);
    border-left:6px solid var(--umkb-orange);
  }
  .toc h3{margin:0 0 8px;color:var(--umkb-blue); font-size:16px}
  .toc ul{list-style:none;padding:0;margin:0}
  .toc li{margin:10px 0}
  .toc a{color:var(--umkb-green);text-decoration:none;font-weight:600}
  .toc a:hover{text-decoration:underline}

  /* Content */
  .content{padding:8px 0}
  .card{
    background:var(--card);
    border-radius:12px;
    padding:22px;
    box-shadow:0 6px 20px rgba(12,18,40,0.04);
    margin-bottom:20px;
    border-left:6px solid var(--umkb-orange);
  }
  h2{color:var(--umkb-blue);margin:0 0 12px;font-size:22px}
  h3{color:var(--umkb-green);margin:18px 0 10px;font-size:18px}
  p, ul{margin:8px 0}
  ul{padding-left:20px}

  /* Collapsible */
  .module-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
  }
  .toggle-btn{
    background:transparent;border:1px solid rgba(0,0,0,0.06);
    padding:8px 12px;border-radius:8px;
    cursor:pointer;font-weight:600;color:var(--umkb-blue);
    transition:.15s;
  }
  .toggle-btn:hover{transform:translateY(-2px)}
  .module-body{margin-top:12px;display:block}
  .module-body.collapsed{display:none}

  /* Formula table */
  .formula-table{width:100%;border-collapse:collapse;margin-top:12px;font-size:15px}
  .formula-table th,.formula-table td{border:1px solid #e6e9ef;padding:10px;text-align:left}
  .formula-table th{background:var(--umkb-blue);color:white;font-weight:600}
  .formula-table tr:nth-child(even){background:#fbfcfe}

  /* Interactive tester */
  .tester{
    display:flex;gap:12px;align-items:center;margin-top:12px;flex-wrap:wrap
  }
  .input{
    flex:1;min-width:220px;padding:10px 12px;border-radius:8px;border:1px solid #d7dbe6;font-size:15px
  }
  .btn{
    background:var(--umkb-green);color:white;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-weight:700;
  }
  .btn.secondary{background:var(--umkb-blue)}
  .result{
    margin-top:12px;padding:12px;border-radius:8px;background:#f3f7ff;border-left:4px solid var(--umkb-blue);
    font-weight:700;color:var(--umkb-blue)
  }

  /* Code / example blocks */
  pre.code{
    background:#0f1724;color:#f8fafc;padding:12px;border-radius:8px;overflow:auto;font-family:Consolas,monospace;font-size:13px;margin-top:10px
  }
  .example{
    display:flex;gap:10px;align-items:center;justify-content:space-between;margin-top:10px
  }
  .copy-btn{background:#eef2ff;border:1px solid #dbe4ff;color:var(--umkb-blue);padding:8px 10px;border-radius:8px;cursor:pointer;font-weight:600}
  .copy-btn:active{transform:translateY(1px)}

  /* small spreadsheet preview */
  .sheet{
    width:100%;border-collapse:collapse;margin-top:12px;font-size:14px
  }
  .sheet th,.sheet td{border:1px solid #e3e6ee;padding:8px;text-align:left;background:white}
  .sheet th{background:#f4f7ff;color:var(--umkb-blue);font-weight:700}
  .sheet tr:nth-child(even) td{background:#fbfcfe}

  /* footer */
  footer{padding:20px;text-align:center;background:var(--umkb-blue);color:white;border-top:4px solid var(--umkb-orange);margin-top:28px}

  /* print friendly */
  @media print{
    .toc, .toggle-btn, .copy-btn, .tester .btn{display:none}
    body{background:white}
    .wrap{grid-template-columns:1fr}
  }
</style>
</head>

<body>

<!-- HERO -->
<section class="hero" role="banner" aria-label="Excel masterclass">
  <img src="logo-umkb.png" alt="UMKB logo" class="logo" />
  <h1>Excel — Masterclass</h1>
  <p><strong>Instructor:</strong> Dr. Zineb Agli — advanced practical course covering interface, formulas, formatting, and labs. This page offers interactive learning and professor-level guidance.</p>
</section>

<!-- MAIN LAYOUT -->
<div class="wrap" role="main">

  <!-- TABLE OF CONTENTS -->
  <aside class="toc" aria-label="Table of contents">
    <h3>Course contents</h3>
    <ul>
      <li><a href="#intro">Introduction & Interface</a></li>
      <li><a href="#workbooks">Workbooks & Worksheets</a></li>
      <li><a href="#data">Entering & Managing Data</a></li>
      <li><a href="#formatting">Formatting & Visualization</a></li>
      <li><a href="#formulas">Formulas & Functions</a></li>
      <li><a href="#lab">Practical Lab (TP1)</a></li>
      <li><a href="#formula-tester">Try a formula</a></li>
      <li><a href="#resources">Resources & Tips</a></li>
    </ul>

    <hr style="margin:14px 0;border:none;border-top:1px solid #eef2f8">

    <h3>Quick links</h3>
    <ul>
      <li><a href="excel-course.html">Original course page</a></li>
      <li><a href="home.html">Back to Courses</a></li>
    </ul>
  </aside>

  <!-- CONTENT -->
  <div class="content">

    <!-- Introduction -->
    <section id="intro" class="card" aria-labelledby="h-intro">
      <div class="module-header">
        <div>
          <h2 id="h-intro">Introduction & Interface</h2>
          <p style="margin-top:6px;color:#475569">Opening Excel reveals a rich interface. Focus on the Ribbon, Quick Access, Formula bar and Status bar — these are your daily tools.</p>
        </div>
        <button class="toggle-btn" data-target="m-intro">Collapse</button>
      </div>

      <div id="m-intro" class="module-body">
        <h3>Key elements (quick guide)</h3>
        <ul>
          <li><strong>Ribbon:</strong> Tabs like Home, Insert, Data — grouped tools for formatting, formulas and charts. Hover to see tooltips.</li>
          <li><strong>Quick Access Toolbar:</strong> Small shortcuts (Save, Undo). Customize for commands you use daily.</li>
          <li><strong>Worksheet grid:</strong> Columns (A, B, C…), Rows (1, 2, 3…) — cells are referenced as A1, B2.</li>
          <li><strong>Formula Bar:</strong> Displays/edit the exact content of the selected cell (text, number or formula).</li>
          <li><strong>Status Bar:</strong> Shows quick calculations (Sum, Average) for the selected range and display options.</li>
        </ul>

        <h3>Professor note</h3>
        <p><em>Always check the formula bar when evaluating student answers: what is visible in the cell may be formatted; the formula bar reveals the true stored value.</em></p>

        <!-- small visual sheet -->
        <table class="sheet" role="table" aria-label="Example sheet">
          <thead>
            <tr><th></th><th>A</th><th>B</th><th>C</th><th>D</th></tr>
          </thead>
          <tbody>
            <tr><th>1</th><td>Item</td><td>Qty</td><td>Unit price</td><td>Total</td></tr>
            <tr><th>2</th><td>Notebook</td><td>3</td><td>6.50</td><td>=B2*C2</td></tr>
            <tr><th>3</th><td>Pen</td><td>10</td><td>0.75</td><td>=B3*C3</td></tr>
            <tr><th>4</th><td><strong>Grand total</strong></td><td></td><td></td><td>=SUM(D2:D3)</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Workbooks -->
    <section id="workbooks" class="card" aria-labelledby="h-workbooks">
      <div class="module-header">
        <div><h2 id="h-workbooks">Workbooks & Worksheets</h2><p style="margin-top:6px">Concepts and best practices for managing multiple sheets and larger projects.</p></div>
        <button class="toggle-btn" data-target="m-workbooks">Collapse</button>
      </div>

      <div id="m-workbooks" class="module-body">
        <h3>Advanced practices</h3>
        <ul>
          <li><strong>Organize by purpose:</strong> raw data, working calculations, presentation sheets.</li>
          <li><strong>Use an index sheet:</strong> list sheets and provide links — improves navigation for students.</li>
          <li><strong>Sheet protection:</strong> lock formulas before sharing with students to prevent accidental edits.</li>
          <li><strong>Versioning:</strong> keep archived copies like <em>grades_v1.xlsx</em> to track changes.</li>
        </ul>

        <h3>Professor tip</h3>
        <p>Teach students to separate data from analysis—this reduces errors and simplifies auditing.</p>
      </div>
    </section>

    <!-- Data -->
    <section id="data" class="card" aria-labelledby="h-data">
      <div class="module-header">
        <div><h2 id="h-data">Entering & Managing Data</h2><p style="margin-top:6px">Good data hygiene is the foundation of reliable analysis.</p></div>
        <button class="toggle-btn" data-target="m-data">Collapse</button>
      </div>

      <div id="m-data" class="module-body">
        <h3>Selecting & Entry</h3>
        <ul>
          <li>Prefer structured ranges and Tables (Insert → Table) — named tables improve formulas.</li>
          <li>Use Data Validation to enforce correct inputs (lists, date ranges, numeric limits).</li>
          <li>Flash Fill for repeated structured patterns (use sparingly; teach correctness first).</li>
        </ul>

        <h3>Data cleaning workflow</h3>
        <ol>
          <li>Keep an original raw tab.</li>
          <li>Make a cleaned copy (remove blanks, trim spaces).</li>
          <li>Normalize formats (dates, text case).</li>
          <li>Document assumptions in a README sheet.</li>
        </ol>
      </div>
    </section>

    <!-- Formatting -->
    <section id="formatting" class="card" aria-labelledby="h-formatting">
      <div class="module-header">
        <div><h2 id="h-formatting">Formatting & Data Visualization</h2><p style="margin-top:6px">Turn numbers into insights with careful formatting and charts.</p></div>
        <button class="toggle-btn" data-target="m-formatting">Collapse</button>
      </div>

      <div id="m-formatting" class="module-body">
        <h3>Key techniques</h3>
        <ul>
          <li><strong>Number formats:</strong> currency, percentage, accounting, or custom formats (e.g., 0.0,"M" for millions).</li>
          <li><strong>Conditional formatting:</strong> color scales, data bars, icon sets — excellent for quick visual triage.</li>
          <li><strong>Tables:</strong> enable filters, structured references and banded rows for readability.</li>
        </ul>

        <h3>Charts & sparklines</h3>
        <p>Use charts to show trends (line), composition (stacked column), or comparison (column). Add sparklines for compact trend indicators next to rows.</p>

        <h3>Professor note</h3>
        <p>Prioritise clarity: choose colors for accessibility; annotate charts with source and calculation notes.</p>
      </div>
    </section>

    <!-- Formulas -->
    <section id="formulas" class="card" aria-labelledby="h-formulas">
      <div class="module-header">
        <div><h2 id="h-formulas">Formulas & Functions — Mastering Excel Formulas</h2>
          <p style="margin-top:6px">Reference table and advanced guidance for common operations.</p></div>
        <button class="toggle-btn" data-target="m-formulas">Collapse</button>
      </div>

      <div id="m-formulas" class="module-body">
        <h3>Operators & Examples</h3>
        <table class="formula-table" role="table" aria-label="Operators table">
          <thead>
            <tr><th>Operation</th><th>Symbol</th><th>Example</th></tr>
          </thead>
          <tbody>
            <tr><td>Addition</td><td>+</td><td><code>=A1 + B1</code></td></tr>
            <tr><td>Subtraction</td><td>-</td><td><code>=A1 - B1</code></td></tr>
            <tr><td>Multiplication</td><td>*</td><td><code>=A1 * B1</code></td></tr>
            <tr><td>Division</td><td>/</td><td><code>=A1 / B1</code></td></tr>
            <tr><td>Exponent</td><td>^</td><td><code>=A1 ^ 2</code></td></tr>
            <tr><td>Percentage</td><td>%</td><td><code>=A1 * 10%</code></td></tr>
          </tbody>
        </table>

        <h3 style="margin-top:14px">Essential functions (with professor notes)</h3>
        <ul>
          <li><strong>SUM(range)</strong>: <code>=SUM(A1:A10)</code> — use for totals; avoid nested SUMs when unnecessary.</li>
          <li><strong>AVERAGE(range)</strong>: useful for central tendency; check for outliers first.</li>
          <li><strong>MIN / MAX</strong>: quick range checks.</li>
          <li><strong>COUNT / COUNTA</strong>: counts of numeric entries vs non-empty cells.</li>
          <li><strong>IF / IFS</strong>: conditional logic. Prefer IFS for multiple conditions in modern Excel.</li>
          <li><strong>VLOOKUP / INDEX+MATCH / XLOOKUP</strong>: teach INDEX+MATCH or XLOOKUP (where available) — they are reliable for two-way lookups.</li>
          <li><strong>TEXT / DATE functions</strong>: TEXT(), DATE(), YEAR(), MONTH() — essential for data normalization.</li>
        </ul>

        <h3>Mastering tips</h3>
        <ul>
          <li>Use parentheses to make order of operations explicit.</li>
          <li>Use named ranges and structured table references for clarity and maintainability.</li>
          <li>Build complex formulas in steps using helper columns for readability and debugging.</li>
          <li>Document your logic in a comment or a help sheet for other readers.</li>
        </ul>

        <div style="margin-top:12px">
          <div class="example">
            <div><strong>Example:</strong> calculate tax — <code>=B2 * 0.17</code></div>
            <button class="copy-btn" data-copy="=B2 * 0.17">Copy</button>
          </div>

          <pre class="code" aria-hidden="true"><code>
=IF(SUM(B2:B10)>1000, "Bonus", "No bonus")
=INDEX(A2:A10, MATCH(E2, B2:B10, 0))
          </code></pre>
        </div>

      </div>
    </section>

    <!-- Formula tester -->
    <section id="formula-tester" class="card" aria-labelledby="h-tester">
      <div class="module-header">
        <div><h2 id="h-tester">Interactive Formula Tester</h2><p style="margin-top:6px">Quickly evaluate simple arithmetic or percent expressions to understand Excel results.</p></div>
        <button class="toggle-btn" data-target="m-tester">Collapse</button>
      </div>

      <div id="m-tester" class="module-body">
        <label for="expr"><strong>Enter expression</strong> (allowed: digits, + - * / ^ ( ) and %):</label>
        <div class="tester">
          <input id="expr" class="input" placeholder="Example: (100 + 50) * 10% + 20" aria-label="Expression input">
          <button id="run" class="btn">Evaluate</button>
          <button id="clear" class="btn secondary">Clear</button>
        </div>
        <div id="res" class="result" aria-live="polite" style="display:none"></div>

        <p style="margin-top:10px;color:#475569">Professor note: this lightweight tester is for arithmetic experimentation. Use Excel for true function parity (dates, text functions, lookup behavior).</p>
      </div>
    </section>

    <!-- Practical lab -->
    <section id="lab" class="card" aria-labelledby="h-lab">
      <div class="module-header">
        <div><h2 id="h-lab">Practical Lab — TP1</h2><p style="margin-top:6px">Hands-on steps and evaluation criteria.</p></div>
        <button class="toggle-btn" data-target="m-lab">Collapse</button>
      </div>

      <div id="m-lab" class="module-body">
        <h3>Task</h3>
        <ol>
          <li>Create workbook named <em>TP Excel</em> with sheets: TP1, TP2, TP3, TP4.</li>
          <li>On <strong>TP1</strong> create a 5×5 table with headers: Item, Qty, Unit price, Discount%, Net price.</li>
          <li>Apply formatting: currency for prices, percentage for discount, conditional formatting for Net price &lt; 5.</li>
          <li>Calculate totals using SUM, create a chart showing item vs net price.</li>
        </ol>

        <h3>Evaluation Rubric</h3>
        <ul>
          <li>Correct formulas and use of functions — 40%</li>
          <li>Formatting & visualization quality — 30%</li>
          <li>Data validation & robustness — 20%</li>
          <li>Documentation & comments — 10%</li>
        </ul>
      </div>
    </section>

    <!-- Resources -->
    <section id="resources" class="card" aria-labelledby="h-resources">
      <div class="module-header">
        <div><h2 id="h-resources">Resources & Further Reading</h2><p style="margin-top:6px">Selected readings, cheatsheets and online references.</p></div>
        <button class="toggle-btn" data-target="m-resources">Collapse</button>
      </div>

      <div id="m-resources" class="module-body">
        <ul>
          <li><a href="https://www.geeksforgeeks.org/excel/introduction-to-ms-excel/" target="_blank" rel="noopener">GeeksforGeeks — Introduction to MS Excel</a></li>
          <li><a href="https://support.microsoft.com/excel" target="_blank" rel="noopener">Microsoft Office Support — Excel</a></li>
          <li><a href="#" id="download-tp">Download TP1 worksheet (placeholder)</a></li>
        </ul>
      </div>
    </section>

    <!-- back -->
    <div style="text-align:center;margin:20px 0 60px">
      <a href="home.html" class="btn" style="text-decoration:none">← Back to Courses</a>
    </div>
  </div>
</div>

<footer>
  © 2025 Teaching Expo — Excel Masterclass · UMKB — Instructor: Dr. Zineb Agli
</footer>

<!-- INTERACTIVITY -->
<script>
  // Collapsible modules & TOC highlighting
  document.querySelectorAll('.toggle-btn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const id = btn.getAttribute('data-target');
      const body = document.getElementById(id);
      if(!body) return;
      const collapsed = body.classList.toggle('collapsed');
      btn.textContent = collapsed ? 'Expand' : 'Collapse';
    });
  });

  // Smooth scroll for TOC links
  document.querySelectorAll('.toc a').forEach(a=>{
    a.addEventListener('click', e=>{
      e.preventDefault();
      const href = a.getAttribute('href');
      const el = document.querySelector(href);
      if(el) el.scrollIntoView({behavior:'smooth',block:'start'});
    });
  });

  // Copy buttons for examples
  document.querySelectorAll('.copy-btn').forEach(b=>{
    b.addEventListener('click', async ()=> {
      const txt = b.getAttribute('data-copy') || b.previousElementSibling?.textContent || '';
      try{
        await navigator.clipboard.writeText(txt.trim());
        b.textContent = 'Copied ✓';
        setTimeout(()=> b.textContent = 'Copy',1200);
      }catch(e){
        alert('Copy failed — your browser may block clipboard access.');
      }
    });
  });

  // Formula tester (safe evaluator)
  const exprIn = document.getElementById('expr');
  const run = document.getElementById('run');
  const clear = document.getElementById('clear');
  const res = document.getElementById('res');

  function sanitizeExpression(raw){
    if(!raw || typeof raw !== 'string') return null;
    // Allow digits, space, operators + - * / ^ ( ) and percent and decimal point
    const allowed = /^[0-9+\-*/^().%\s,]+$/;
    if(!allowed.test(raw)) return null;
    // Convert commas to dot for decimals if user uses comma
    let s = raw.replace(/,/g,'.');
    // Replace percent: convert numbers followed by % into (n/100)
    s = s.replace(/(\d+(\.\d+)?)\s*%/g, '($1/100)');
    // Replace ^ with ** for JS exponentiation
    s = s.replace(/\^/g, '**');
    return s;
  }

  run.addEventListener('click', ()=>{
    const raw = exprIn.value.trim();
    const safe = sanitizeExpression(raw);
    if(!safe){
      res.style.display='block'; res.textContent = 'Expression invalid — only numbers and + - * / ^ ( ) % allowed.';
      return;
    }
    try{
      // eslint-disable-next-line no-new-func
      const fn = new Function('return ('+safe+')');
      const value = fn();
      res.style.display='block';
      res.textContent = 'Result: ' + (Number.isFinite(value) ? value : String(value));
    }catch(e){
      res.style.display='block';
      res.textContent = 'Error evaluating expression: ' + e.message;
    }
  });

  clear.addEventListener('click', ()=>{
    exprIn.value=''; res.style.display='none';
  });

  // Highlight TOC based on scroll (simple)
  const sections = Array.from(document.querySelectorAll('section[id]'));
  function onScroll(){
    const pos = window.scrollY + 120;
    let active = sections.find(s => s.offsetTop <= pos && (s.offsetTop + s.offsetHeight) > pos);
    if(!active) active = sections[0];
    document.querySelectorAll('.toc a').forEach(a=> a.style.fontWeight='600');
    if(active){
      const link = document.querySelector('.toc a[href="#'+active.id+'"]');
      if(link) link.style.fontWeight='900';
    }
  }
  window.addEventListener('scroll', onScroll);
  onScroll();

  // Download placeholder TP1 (you can replace with actual file URL)
  document.getElementById('download-tp').addEventListener('click', (e)=>{
    e.preventDefault();
    alert('TP1 download placeholder. I can generate a ready TP1 workbook (xlsx) and link it here if you want.');
  });
</script>
</body>
</html>
